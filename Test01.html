<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ส่งข้อความ + รูปจากผู้ใช้ไป LINE</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>

<h2>ส่งข้อความและรูปไป LINE</h2>

<label>ชื่อ: <input type="text" id="name"></label><br><br>
<label>ข้อความ: <input type="text" id="msg"></label><br><br>
<label>รูป: <input type="file" id="fileInput" accept="image/*" capture="camera"></label><br><br>

<button onclick="sendToLine()">ส่งไป LINE</button>

<script>
async function sendToLine() {
    const name = document.getElementById('name').value;
    const msg = document.getElementById('msg').value;
    const fileInput = document.getElementById('fileInput');
    
    if(fileInput.files.length === 0) {
        alert("กรุณาเลือกหรือถ่ายรูปก่อน");
        return;
    }

    const file = fileInput.files[0];

    try {
        // 1. อัปโหลดไฟล์ไป server ของคุณ
        const formData = new FormData();
        formData.append('image', file);

        const uploadResp = await fetch('https://your-server.com/upload', {
            method: 'POST',
            body: formData
        });

        const data = await uploadResp.json();
        const imageUrl = data.url; // server ต้องส่ง URL ของไฟล์กลับ

        // 2. เริ่ม LIFF
        await liff.init({ liffId: "2007956727-xavQye3Q" });

        // 3. ส่งข้อความ + รูปไป LINE
        await liff.sendMessages([
            { type: 'text', text: `ชื่อ: ${name}\nข้อความ: ${msg}` },
            { type: 'image', originalContentUrl: imageUrl, previewImageUrl: imageUrl }
        ]);

        alert("ส่งข้อความและรูปไป LINE เรียบร้อย!");
    } catch (err) {
        console.error(err);
        alert("เกิดข้อผิดพลาด: " + err);
    }
}
</script>

</body>
</html>
